# Vello CPU Recording API Alignment Plan

The current managed bindings omit several recording-centric entry points that the Rust `vello_cpu_ffi` layer already exposes. This plan captures the work needed to close the gap across the slim native layer (`Vello.Native`), the higher-level managed wrapper (`Vello`), and the associated test suites.

1. [x] Align `Vello.Native` P/Invoke surface for recording features — add declarations for `vello_recording_has_cached_strips`, `vello_recording_strip_count`, `vello_recording_alpha_count`, and the recorder paint/clip helpers in `dotnet/Vello.Native/NativeMethods.cs`; extend the fast-path wrappers (`FastPath/NativeRecording.cs`, `FastPath/NativeRenderContext.cs`, and any supporting types) to surface the new functionality safely.
2. [x] Extend managed recording abstractions — enrich `dotnet/Vello/Core/Recording.cs` with cache/strip introspection APIs and update `dotnet/Vello/Core/Recorder.cs` to mirror the native recorder capabilities (`SetStroke`, `SetTransform`, `SetFillRule`, `SetPaintTransform`, `ResetPaintTransform`, `PushClipLayer`, `PopLayer`, etc.), keeping parity with `RenderContext`.
3. [x] Add native interop regression tests — create or expand tests under `dotnet/Vello.Tests/Interop` to exercise the new P/Invoke entry points (e.g., verifying strip/alpha counters and recorder clip/transform calls via `NativeTestHelpers`).
4. [x] Add managed-level unit coverage — update `dotnet/Vello.Tests/RecordingTests.cs` (and related fixtures) to validate the new `Recording` properties and `Recorder` methods end-to-end through `RenderContext.Record`.
5. [x] Refresh developer collateral — document the expanded recording surface in `docs/API_COVERAGE.md` (or a targeted section) and ensure any samples or usage guides reflect the new recorder capabilities.
6. [x] Verify end-to-end — run the affected test projects (`dotnet test` for `Vello.Tests`, plus any focused interop suites) and perform a smoke run of existing samples/benchmarks that rely on recording to confirm the additions integrate cleanly.
